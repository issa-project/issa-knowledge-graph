log_enable(3,1);
SPARQL CLEAR GRAPH  <$ARGV[$I]graph/openalex-authorships>;


DELETE FROM DB.DBA.load_list;
ld_dir ('/database/import', 'openalex-authorships.ttl', '$ARGV[$I]graph/openalex-authorships');

rdf_loader_run ();
checkpoint;

-- output possible load errors
SELECT * FROM DB.DBA.load_list;

SPARQL SELECT DISTINCT (<$ARGV[$I]graph/openalex-authorships> as ?g)  (COUNT(*) as ?triples)  
WHERE { GRAPH <$ARGV[$I]graph/openalex-authorships> {?s ?p ?o} };

exit;
