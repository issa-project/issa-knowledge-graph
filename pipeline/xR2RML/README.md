To transform data collected in the metadata, indexing and annotation steps that is generaly represented in JSON format  into [RDF](https://www.w3.org/RDF/) we use [Morph-xR2RML](https://github.com/frmichel/morph-xr2rml) tool. This tool takes the following input 
- a [database query](https://www.mongodb.com/docs/manual/tutorial/query-documents/) as data input
- [R2RML](https://www.w3.org/TR/r2rml/) mapping language templates as transformation instructions.

>:point_right: In ISSA we chose to use MongoDB as an intermediate queriable database storage as a most suitable for the JSON import, see [mongo](../mongo) for details.

Example of transformation:
<table> <tbody>
<tr><td>Input JSON</td><td><pre>
{ "paper_id" : "123456", 
  "title" :"The irreversible momentum of clean energy", 
  "authors": ["Obama, Barack"]  } </pre></td></tr>
<tr><td>xR2RML mapping</td><td><pre>
<#LS> 
   a xrr:LogicalSource;   
   xrr:query """db.metadata.find( { paper_id: { $exists: true} } )""".
<#TM> 
   a rr:TriplesMap; 
   xrr:logicalSourse <#LS>;
   rr:subjectMap [
            rr:template "http://example.org/article/{$.paper_id}"   ];        
   rr:predicateObjectMap [ 
           rr:predicate dct:title; 
           rr:objectMap [ xrr:reference "$.title"; ];   ];
   rr:predicateObjectMap [
           rr:predicate dca:creator;
           rr:objectMap [ xff:reference "$.authors.*"; ] ].</pre> </td></tr>
<tr><td>Output RDF</td><td><pre>
&lthttp://example.org/article/123456&gt dct:title "Irreversible momentum of clean energy".
&lthttp://example.org/article/123456&gt dca:creator "Obama, Barack". </pre> </td></tr>
</tbody></table>

 
This folder provides the scripts, configuration and mappings files needed for transformation to RDF: 

- script `run-transformation.sh` is the main entry point. Comment or uncomment the lines as needed.
- the configuration `*.properies` for java applications fies can be reused without modifications.
>:point_right: However, since each update of ISSA dataset is stored in a separate database one parameter *database.name* will be assigned automatically to the latest update  defined in [env.sh](../../env.sh).
- the mapping files `*.tpl.ttl` provide the mapping between RDF triple's *subjects* and *objects* and fields in a database collection to build a desired knowledge graph. For simplicity each file corresponds to one collection or a filtered subset defined by a query.    
-- `xr2rml_document_metadata.tpl.ttl` maps the the metadata fields and is the one that most likely should be modified for each use case of ISSA as the metadata might be different per use case
-- the other `*.tpl.ttl` map the data generated by ISSA pipeline and therefore can be used as-is for other use cases  
-- to reduce the size of RDF files for the numerous annotations the `_annot.tpl.ttl` mappings of the annotation are done per article part (title, abstarct, body) and take an extra parameter

